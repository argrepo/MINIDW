DROP TABLE IF EXISTS ETL_CNTRL;
DROP TABLE IF EXISTS ETL_JOB_ERROR_LOG;
DROP TABLE IF EXISTS ETL_JOB_LOAD_SMRY;
DROP TABLE IF EXISTS ETL_Jobs;

CREATE TABLE ETL_CNTRL (
  DataSource_Id varchar(200) NOT NULL,
  CTRL_ID int(11) NOT NULL AUTO_INCREMENT,
  JOB_NAME varchar(50) DEFAULT NULL,
  JOB_ORDER_SEQ int(11) DEFAULT NULL,
  SOURCE_UPD_DATETIME datetime DEFAULT NULL,
  LAST_RUN_DATETIME datetime DEFAULT NULL,
  ADDED_DATE datetime DEFAULT NULL,
  ADDED_USER varchar(50) DEFAULT NULL,
  UPDATED_DATE datetime DEFAULT NULL,
  UPDATED_USER varchar(50) DEFAULT NULL,
  PRIMARY KEY (CTRL_ID,DataSource_Id)
)ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;

CREATE TABLE ETL_JOB_ERROR_LOG (
  DataSource_Id varchar(200) NOT NULL,
  ERROR_ID bigint(20) NOT NULL AUTO_INCREMENT,
  BATCH_ID varchar(200) DEFAULT NULL,
  ERROR_CODE varchar(100) DEFAULT NULL,
  ERROR_TYPE varchar(50) DEFAULT NULL,
  ERROR_MSG varchar(5000) DEFAULT NULL,
  ERROR_SYNTAX varchar(5000) DEFAULT NULL,
  DATA_VALUE_SET varchar(5000) DEFAULT NULL,
  ADDED_DATETIME datetime DEFAULT NULL,
  ADDED_USER varchar(50) DEFAULT NULL,
  UPDATED_DATETIME datetime DEFAULT NULL,
  UPDATED_USER varchar(50) DEFAULT NULL,
  PRIMARY KEY (ERROR_ID,DataSource_Id)
)ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;

CREATE TABLE ETL_JOB_LOAD_SMRY (
  DataSource_Id varchar(200) NOT NULL,
  BATCH_ID varchar(200) NOT NULL,
  JOB_NAME varchar(200) DEFAULT NULL,
  JOB_PARAMETERS varchar(1000) DEFAULT NULL,
  SRC_COUNT int(11) DEFAULT NULL,
  TGT_INSERT_COUNT int(11) DEFAULT NULL,
  TGT_UPDATE_COUNT int(11) DEFAULT NULL,
  TGT_DELETE_COUNT int(11) DEFAULT NULL,
  ERROR_ROWS_COUNT int(11) DEFAULT NULL,
  JOB_START_DATETIME datetime DEFAULT NULL,
  JOB_END_DATETIME datetime DEFAULT NULL,
  JOB_RUN_STATUS varchar(50) DEFAULT NULL,
  JOB_LOG_FILE_LINK varchar(5000) DEFAULT NULL,
  ADDED_DATETIME datetime DEFAULT NULL,
  ADDED_USER varchar(50) DEFAULT NULL,
  UPDATED_DATETIME datetime DEFAULT NULL,
  UPDATED_USER varchar(50) DEFAULT NULL,
  PRIMARY KEY (BATCH_ID,DataSource_Id)
)ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;


CREATE TABLE ETL_Jobs (
  DataSource_Id varchar(200) NOT NULL,
  JOB_ID int(10) NOT NULL AUTO_INCREMENT,
  JOB_NAME varchar(50) DEFAULT NULL,
  JOB_DESCRIPTION varchar(100) DEFAULT NULL,
  JOB_TYPE varchar(100) DEFAULT NULL,
  SOURCE_TBL_NAME varchar(200) DEFAULT NULL,
  TARGET_TBL_NAME varchar(200) DEFAULT NULL,
  ADDED_DATETIME datetime DEFAULT NULL,
  ADDED_USER varchar(50) DEFAULT NULL,
  UPDATED_DATETIME datetime DEFAULT NULL,
  UPDATED_USER varchar(50) DEFAULT NULL,
  PRIMARY KEY (JOB_ID,DataSource_Id)
)ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;

CREATE TABLE DataModel_Version (
  Current_Version varchar(200),
  Rollout_Date datetime
)ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;

Insert into DataModel_Version Values('DM V1.4.0',now());
